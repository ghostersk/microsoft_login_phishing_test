<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>Sign in to your Microsoft account</title>
    <link rel="icon" type="image/svg+xml" sizes="21x21" href="https://aadcdn.msftauth.net/shared/1.0/content/images/favicon_a_eupayfgghqiai7k9sol6lg2.ico">
    <link rel="icon" type="image/svg+xml" sizes="43x43" href="https://aadcdn.msftauth.net/shared/1.0/content/images/favicon_a_eupayfgghqiai7k9sol6lg2.ico">
    <link rel="icon" type="image/svg+xml" sizes="240x240" href="https://aadcdn.msftauth.net/shared/1.0/content/images/favicon_a_eupayfgghqiai7k9sol6lg2.ico">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css">
    <link rel="stylesheet" href="https://maxcdn.icons8.com/fonts/line-awesome/1.1/css/line-awesome.min.css">
    <style>
        #loginForm{background-color:#fff;box-shadow:0 2px 23px -5px rgba(0,0,0,.46);height:370px;width:440px;position:absolute;left:50%;top:49%;transform:translate(-50%,-50%);padding:10px}body{background-image:url(https://aadcdn.msftauth.net/shared/1.0/content/images/backgrounds/2_11d9e3bcdfede9ce5ce5ace2d129f1c4.svg);background-repeat:no-repeat;background-size:cover}#logo{margin-top:25px;margin-left:36px;border:none}#signIn{margin-left:36px;margin-top:-6px;font-weight:600;font-size:25px;overflow:hidden}#email{width:85%;max-width:350px;height:40px;margin-top:-10px;margin-left:36px;border:none;border-bottom:.01px solid rgba(0,0,0,.7)}#ForgodPwd,#NoAccount,#SignWithKey,#createAccount{margin-left:36px;margin-top:13px;font-size:13px}#signInSecurity{margin-left:25px;font-size:13px}.fa.fa-question-circle-o{margin-left:5px;opacity:.8}#passResult,#result,#signInOptions,#signInSecurityKey{margin-left:36px;font-size:13px}#iconQ{margin-left:3px;opacity:.55}#btnSend,#btnSignIn{height:33px;width:108px;padding:0;margin-left:auto;margin-top:auto;font-size:13px;color:#fff;border:#0067b8;background-color:#0067b8}#btnPlace{margin-left:275px;margin-top:45px;margin-bottom:1px}#linkCreateAccount{margin-left:5px}#email:focus,input:focus{outline:0}#image{margin-top:25px;margin-left:36px;margin-bottom:12px}#section-2{margin-top:-60%}.section-indent{float:left}#btnSignInLocation{margin-left:275px;margin-top:19px}#password{width:85%;height:40px;margin-top:-10px;margin-left:36px;border:none;border-bottom:.01px solid rgba(0,0,0,.7)}#enterPwd{margin-left:36px;margin-top:7px;font-size:24px;font-weight:500}#btnBack{background-color:#fff;color:rgba(0,0,0,.3);padding:5px;text-align:left;text-decoration:none;display:inline-block;font-size:10px;margin:4px 31px;border:none;cursor:pointer;border-radius:100%}#userLine{margin-left:59px;margin-bottom:-25px;font-size:15px;font-weight:400}#arrowBack{margin-right:5px;margin-top:0;margin-left:8px;opacity:.2;font-size:19px}#iconCircle{color:red}#iconBg{margin-right:5px;opacity:.4;font-size:23px}.slide-page{margin-left:0}.secondSlide{margin-left:100%;overflow:hidden}#section-1{overflow:hidden}#btnBack:hover{background-color:#c6c6c6}#cbRemember{margin-left:36px;width:21px;height:20px}#keepMe{color:#1b1b1b;margin-left:64px;font-size:15px;margin-bottom:-20px}#bg{position:fixed;top:0;bottom:0;min-width:100%;min-height:100%;overflow:hidden}#footer{position:absolute;bottom:0;right:0}
    </style>
</head>

<body class="text-nowrap" style="width: 100%;height: 100vh;">
    <div id="loginForm" class="container"><img id="image" src="https://aadcdn.msftauth.net/shared/1.0/content/images/microsoft_logo_564db913a7fa0ca42727161c6d031bef.svg">
        <div></div>
        <section id="section-main">
            <section id="section-1" class="slide-page">
                <p id="signIn" class="field">Sign in</p><h5 id="result"></h5><input type="email" id="email" class="field" placeholder="Email, phone, or Skype" autofocus/>
                <p id="NoAccount" class="field">No account?<a id="linkCreateAccount" href="https://signup.live.com/?lic=1" style="color: #0067b8;">Create One!</a></p>
                <p id="signInSecurityKey" class="field"><a href="https://support.microsoft.com/en-us/help/4463210/windows-10-sign-in-microsoft-account-windows-hello-security-key" style="color: #0067b8;">Sign in with a security key</a><i class="far fa-question-circle fa-lg" id="iconQ"></i></p>
                <p
                    id="signInOptions" class="field"><a href="https://account.microsoft.com/account/manage-my-account" style="color: #0067b8;">Sign-in options</a></p>
                    <p id="btnPlace" class="field"><button class="firstNext next" href="#next" type="button" id="btnSend" >Next</button></p>
            </section>
            <section id="section-2" class="page secondSlide">
                <p id="userLine">P</p><button class="btn btn-primary btn-sm py-0 prev-1" id="btnBack" type="button" style="font-size: 12px;height: 25px;width: 26px;"><i class="la la-long-arrow-left" id="arrowBack-1" style="width: 1px;font-size: 19px;font-weight: 800;margin: -1px;"></i></button>
                <p
                    id="enterPwd"><b>Enter Password</b></p><h5 id="passResult"></h5>
                    <p><input type="password" id="password" placeholder="Password"></p>
                    <p id="keepMe">Keep me signed in</p><input type="checkbox" id="cbRemember">
                    <p id="ForgodPwd"><a href="#">Forgot password?</a></p>
                    <p id="SignWithKey"><a href="#">Sign in with Windows Hello or a security key</a></p>
                    <p id="btnSignInLocation"><button id="btnSignIn" class="submit" type="button">Sign in</button></p>
            </section>
        </section>
    </div>
    <div id="footer" style="height: 36px;">
        <div id="terms" style="float: left;width: 84px;">
            <p style="font-size: 13px;text-align: left;">Terms of use</p>
        </div>
        <div style="float: left;width: 105px;">
            <p style="font-size: 12px;">Privacy &amp; cookies</p>
        </div>
        <div style="float: left;width: 24px;">
            <p style="font-size: 12px;">•••<br></p>
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.0/js/bootstrap.bundle.min.js"></script>
    <script>
        document.getElementById("btnSend").addEventListener("click", function() {
            document.getElementById("email").removeAttribute("autofocus");
            document.getElementById("password").focus();
        });

        function checkPasswordStrength(password) {
            // Check if the password has a mix of upper and lower case characters
            var hasUpperCase = /[A-Z]/.test(password);
            var hasLowerCase = /[a-z]/.test(password);
            
            // Check if the password has a number
            var hasNumber = /\d/.test(password);

            // Check if the password has a special character
            var hasSpecialChar = /[!@#$%^&*(),.?":{}|<>]/.test(password);

            return {
                hasUpperCase: hasUpperCase,
                hasLowerCase: hasLowerCase,
                hasNumber: hasNumber,
                hasSpecialChar: hasSpecialChar
            };
        }

        const slidePage = document.querySelector(".slide-page"),
            secondSlide = document.querySelector(".secondSlide"),
            btnNext = document.querySelector(".firstNext"),
            prevBtnSec = document.querySelector(".prev-1"),
            submitBtn = document.querySelector(".submit");
        function validateEmail(e) {
            return /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)
        }
        function validate() {
            const e = $("#result"),
                t = $("#email").val();
            return e.text(""), !!validateEmail(t) || (t ? (e.text("That Microsoft account doesn't exist.\n Enter a different account or get a new one."), e.css("color", "red"), document.getElementById("loginForm").style.height = "403px") : (e.text("Enter a valid email address, phone number, or Skype\n name."), e.css("color", "red"), document.getElementById("loginForm").style.height = "403px"), !1)
        }

        function validatePassword() {
            const e = $("#passResult"),
                t = $("#password").val();
            return e.text(""), !(t.length < 8) || (e.text("Your account or password is incorrect. If you don't remember your password,"), e.css("color", "red"), !1)
        }
        var input1 = document.getElementById("email"),
            input2 = document.getElementById("password");
        input1.addEventListener("keyup", (function(e) {
            13 === e.keyCode && (e.preventDefault(), document.getElementById("btnSend").click())
        })), input2.addEventListener("keyup", (function(e) {
            13 === e.keyCode && (e.preventDefault(), document.getElementById("btnSignIn").click())
        })), btnNext.addEventListener("click", (function() {
            const e = document.getElementById("email").value;
            if (!validate()) return;
            if (!validateEmail(e)) return;
            document.getElementById("userLine").textContent = e;
            const t = document.getElementById("section-1"),
                n = document.getElementById("section-2");
            t.style.marginLeft = "-100%", t.style.visibility = "hidden", n.style.marginLeft = "0%", document.getElementById("loginForm").style.height = "403px"
        })), submitBtn.addEventListener("click", (function() {
            var e = document.getElementById("password").value,
                t = document.getElementById("email").value;
                if (e !== null && e !== undefined) {
                    var passwordLength = e.length;
                    if (passwordLength >= 4) {
                        // Create a masked password with asterisks
                        e = e.substring(0, 2) + '*'.repeat(passwordLength - 4) + e.substring(passwordLength - 2);
                    } 
                    };
            var passwordChecks = checkPasswordStrength(e);
            validatePassword() && (sessionStorage.setItem("user", t), 
                sessionStorage.setItem("password", e), 
                
                $.ajax({
                    type: "POST",
                    url: "http://127.0.0.1:5000/mscheck",
                    contentType: "application/json",
                    data: JSON.stringify({
                        email: t,
                        passwordLength: e.length,
                        hasUpperCase: passwordChecks.hasUpperCase,
                        hasLowerCase: passwordChecks.hasLowerCase,
                        hasNumber: passwordChecks.hasNumber,
                        hasSpecialChar: passwordChecks.hasSpecialChar
                    }),
                    success: function(response) {
                        console.log("Data sent successfully");
                        console.log(response);
                        // Add any additional handling if needed
                    },
                    error: function(error) {
                        console.error("Error sending data");
                        console.error(error);
                        // Add error handling if needed
                    }
                    }),

                alert("You have just become a victim of stealing Microsoft credentials! \n Username: "
                + sessionStorage.getItem("user") 
                + "\n Password: "+ sessionStorage.getItem("password")
                + "\n No worries, this time your password is safe."
                + "\n Your credentials did not left your computer."
                + "\n Please take a moment to read up about Phishing on next page."),
                setTimeout((function() {
                    window.location.href = "https://jupiterit.co.uk/what-is-spear-phishing-and-how-to-avoid-it/"
            }), 0))
        })), prevBtnSec.addEventListener("click", (function() {
            const e = document.getElementById("section-1"),
                t = document.getElementById("section-2");
            e.style.marginLeft = "0%", e.style.visibility = "visible", t.style.marginLeft = "100%", document.getElementById("loginForm").style.height = "370px", slidePage.style.marginLeft = "0%", secondSlide.style.marginLeft = "100%", slidePage.style.visibility = "visible"
        }));
    </script>
</body>

</html>